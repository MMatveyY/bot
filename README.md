# Инструмент для тестирования WAF на устойчивость к XSS-атакам

## Описание

Специализированный инструмент для комплексной оценки устойчивости межсетевых экранов веб-приложений (WAF) к атакам типа XSS. Приложение использует машинное обучение для генерации адаптивных и уникальных пейлоадов, что значительно улучшает точность и гибкость тестирования.

## Основные возможности

- **Генерация XSS-пейлоадов** с использованием ML-мутатора для создания адаптивных атак
- **Отправка тестовых запросов** к WAF через различные методы (GET, POST, заголовки)
- **Анализ ответов WAF** для определения блокировки/пропуска атак
- **Формирование отчетов** в форматах JSON, TXT и HTML с детализацией результатов

## Требования

- Python 3.8 или выше
- Windows 11 (или совместимая ОС)
- Оперативная память: 16 ГБ (рекомендуется)
- Процессор: 8-ядерный (рекомендуется)
- Стабильное интернет-соединение
- Дисковое пространство: не менее 20 ГБ

## Установка

1. Клонируйте репозиторий или распакуйте архив:
```bash
cd A:\123123123
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. (Опционально) Если у вас есть обученная ML модель, поместите её в:
   - `A:\Diplome\ML\ml\models\xss_model.pt`

4. (Опционально) Если у вас есть файл с базовыми пейлоадами, поместите его в:
   - `A:\Diplome\ML\ml\data\xss-list-unique.txt`

## Использование

### Графический интерфейс (GUI)

Для запуска графического интерфейса:

```bash
python run_gui.py
```

Или:

```bash
python -m waf_tester.gui
```

Графический интерфейс предоставляет:
- Настройку параметров тестирования
- Визуальный прогресс тестирования
- Просмотр результатов в таблице
- Фильтрацию результатов
- Генерацию отчетов в различных форматах
- Просмотр детальной информации о каждом тесте

### Командная строка (CLI)

Базовое использование:

```bash
python waf_tester/main.py --url http://example.com
```

### Расширенные опции

```bash
# Тестирование с ограничением количества пейлоадов
python waf_tester/main.py --url http://example.com --max-payloads 50

# Тестирование без использования ML
python waf_tester/main.py --url http://example.com --no-ml_models

# Тестирование через POST запросы
python waf_tester/main.py --url http://example.com --test-type post

# Использование собственного файла с пейлоадами
python waf_tester/main.py --url http://example.com --payloads-file payloads.txt

# Использование собственной ML модели
python waf_tester/main.py --url http://example.com --model-path path/to/model.pt

# Настройка задержки между запросами
python waf_tester/main.py --url http://example.com --request-delay 1.0
```

### Параметры командной строки

- `--url` (обязательный) - URL целевого веб-приложения за WAF
- `--payloads-file` - путь к файлу с базовыми пейлоадами
- `--model-path` - путь к обученной ML модели
- `--no-ml` - не использовать ML для генерации пейлоадов
- `--max-payloads` - максимальное количество пейлоадов (по умолчанию: 100)
- `--request-delay` - задержка между запросами в секундах (по умолчанию: 0.5)
- `--test-type` - тип теста: get, post или header (по умолчанию: get)

## Структура проекта

```
waf_tester/
├── __init__.py              # Инициализация пакета
├── main.py                   # Главный модуль запуска
├── payload_generator.py      # Генератор XSS-пейлоадов с ML
├── request_sender.py         # Модуль отправки HTTP-запросов
├── response_analyzer.py     # Анализатор ответов WAF
└── report_generator.py       # Генератор отчетов

config.yaml                   # Конфигурационный файл
requirements.txt              # Зависимости проекта
README.md                     # Документация
```

## Формат отчетов

После завершения тестирования генерируются три типа отчетов:

1. **JSON отчет** (`waf_test_report_YYYYMMDD_HHMMSS.json`) - структурированные данные для программной обработки
2. **Текстовый отчет** (`waf_test_report_YYYYMMDD_HHMMSS.txt`) - читаемый текстовый формат
3. **HTML отчет** (`waf_test_report_YYYYMMDD_HHMMSS.html`) - визуализированный отчет с таблицами и статистикой

Все отчеты сохраняются в директории `reports/`.

## ML-мутатор

Приложение использует машинное обучение для генерации адаптивных пейлоадов:

- **Оценка пейлоадов** - ML модель оценивает вероятность успешного выполнения пейлоада
- **Beam search** - алгоритм поиска лучших вариантов мутаций
- **Адаптивная генерация** - пейлоады генерируются с учетом особенностей целевого WAF

Если ML модель недоступна, используется простой мутатор на основе правил.

## Безопасность

⚠️ **ВАЖНО**: Данный инструмент предназначен исключительно для тестирования собственных систем или систем с явного разрешения владельцев.

- Тестирование только в тестовых средах
- Запрещается применение в отношении систем без разрешения
- Изоляция тестового стенда от продуктивных сетей
- Соблюдение законодательства в области информационной безопасности

## Примеры результатов

```
СВОДКА РЕЗУЛЬТАТОВ
================================================================================
Всего тестов: 100
Заблокировано: 85 (85.00%)
Пропущено: 12 (12.00%)
Ошибки: 3
Тип WAF: ModSecurity
================================================================================
```

## Устранение неполадок

### ML модель не загружается
- Убедитесь, что файл модели существует по пути `A:\Diplome\ML\ml\models\xss_model.pt`
- Проверьте, что установлены все зависимости: `pip install torch numpy`
- Используйте флаг `--no-ml` для работы без ML

### Ошибки подключения
- Проверьте доступность целевого URL
- Убедитесь, что WAF не блокирует ваш IP
- Попробуйте увеличить `--request-delay`

### Недостаточно памяти
- Уменьшите `--max-payloads`
- Используйте `--no-ml` для снижения потребления памяти

## Лицензия

Разработано в рамках дипломного проекта.

## Контакты

Для вопросов и предложений обращайтесь к разработчику.

